# 15장. 웹 서비스와 네트워크

**서비스의 성장**

## **강의 38: 네트워크 분기점**

### 1. 서비스 성장과 네트워크 분기점

- 작은 트래픽일 때는 네트워크에 별 문제 없을 수 있음
- 하지만 서비스가 성장하면 네트워크 구조가 병목이 되기 시작함
- 네 가지 핵심 분기점:
    - **1Gbps 한계(PC 라우터 성능 한계)**
    - **500호스트 한계(ARP 테이블 한계, 브로드캐스트 증가)**
    - **글로벌화 → 데이터센터의 위치 문제**
    - **트래픽 증가에 따른 구조 변화 필요**

### 1Gbps의 한계 – PC 라우터의 구조적 한계

- 리눅스 PC 기반 라우터의 실제 처리 성능 → 약 **30만 pps(300kpps)** 수준
- 평균 패킷 크기 300바이트 정도일 때 **30만 × 300byte ≈ 1Gbps**가 됨
- 즉, **패킷 처리량이 한계라서 1Gbps 이상으로 못 올라감**
- 그래서 하테나는 고성능 라우터(예: Cisco)를 검토했지만 비용 문제, 기존 구조에 맞지 않는 운영 부담

때문에 쉽게 도입하지 못함

### 500호스트의 한계 – ARP 테이블 / 브로드캐스트 문제

- 스위치의 **ARP 테이블이 일정 수를 넘으면 오래된 ARP 캐시가 밀림 → 패킷 손실** 발생
- 하테나는 자체 조사로 **500호스트 전후**에서 문제가 시작됨을 확인
- 브로드캐스트 트래픽 증가 → CPU 부하 증가 → 패킷 드랍 위험 증가
- 결국 하나의 서브넷당 **500대를 넘기 어려움**

### 네트워크 구조 계층화

- 네트워크를 3단 구조로 나누는 것이 일반적인 의견:
    - **Access 계층**: 서버가 직접 붙는 가장 작은 단위
    - **Distribution 계층**: Access를 여러 개 묶는 중간 라우터
    - **Core 계층**: 전체 네트워크의 중심
- 서버 100~200대 정도 / VLAN 1000개 단위까지 커버 가능

<img width="695" height="588" alt="image" src="https://github.com/user-attachments/assets/54bd6642-2b7d-4bb5-9cbf-26f574c3a035" />

- Access–Distribution–Core의 3계층 구조 다이어그램
- VLAN 분리, OSPF 영역 분할, VRRP 구성 등이 포함된 전형적인 엔터프라이즈 네트워크 방식

### 글로벌화 – 태평양을 넘는 액세스

- 일본 사용자라면 일본 DC가 빠르지만, 미국/유럽 사용자는 latency가 커짐
- FLV, 이미지 등 대용량 미디어는 **HTTP로 직접 전송하면 회선 비용 폭증**
- 따라서 **CDN 사용은 필수.** 하테나는 Amazon CloudFront 사용

### CDN 선택 – Amazon CloudFront 중심

- 세계 주요 CDN: Akamai, Limelight, CloudFront 등
- CloudFront가 일본에 로케이션을 두기 시작하면서 비용·성능 균형이 좋아져 하테나가 선택
- 원본 파일은 Amazon S3에 저장 → CloudFront가 엣지로 전송하여 전 세계에 제공

## **강의 39. 한층 높은 단계로**

### 10Gbps 이상의 세계

- 10Gbps급 네트워크는:
    - **AS 번호(Autonomous System)** 필요
    - IX(Internet Exchange) 접속 필요
    - **BGP 프로토콜**로 라우팅 제어
- AS 간 네트워크는 사업자 간 계약 기반 → 대규모 서비스에서 필수

### 하테나의 인프라 (11~15장)

핵심 요소 정리:

- 확장성
- 다중화
- 효율향상
- 네트워크 구조

네 가지가 하테나가 인프라를 구성하며 가장 신경 썼던 포인트
